<div class="card card-main-content">
  <!-- <div class="card card-main-content" style="position: relative;"> -->

  <div class="card-header">
      <h2 class="card-title"><b>
      </b></h2>
  </div>



<!-- inicio -->

<!-- <div class="card-body" style="width: 100%; height: 100%;  position: absolute; top: 50%; left:-10%;"> -->
<div class="card-body-datatable">


<div class="content-wrapper">
  <!-- Content Header (Page header) -->
  <section class="content-header">
    <div class="container-fluid">
      <div class="row mb-2">
        <div class="col-sm-6">
          <h1 id="saludos"></h1>
        </div>
        <div class="col-sm-6">
          <ol class="breadcrumb float-sm-right">
            <li class="breadcrumb-item active">
              <!-- <button class="btn btn-success btn-sm float-right" type="submit"> -->
                <!-- <i class="fas fa fa-plus" aria-hidden="true" id="crear"></i> -->
              <!-- </button> -->
            </li>
            <!-- <li class="breadcrumb-item active">Tabla de Vehiculo</li> -->
          </ol>
        </div>
      </div>
    </div><!-- /.container-fluid -->
  </section>

  <!-- Main content -->
  <section class="content">
    <div class="container-fluid">
      <div class="row">
        <div class="col-12">


          <div class="card">
            <div class="card-header">
              <h3 class="card-title">Lista Tipo Vehiculo y Partes</h3>
            </div>
            <!-- /.card-header -->
            <div class="card-body">
              <table id="example1" class="table table-bordered table-striped">
              


              </table>
            </div>
            <!-- /.card-body -->
          </div>
          <!-- /.card -->
        </div>
        <!-- /.col -->
      </div>
      <!-- /.row -->
    </div>
    <!-- /.container-fluid -->
  </section>
  <!-- /.content -->
</div>
</div>
<!-- fin -->

<div id="mymodal">
  
</div>

  <div class="card-footer">
    <!-- Footer -->
  </div>

</div>

<script>

var organizarDatos = function( data ) {  //TODO: revisar este codigo
    var arrTipovehiculos = [];
//  console.log(data);
 var i = 0;
    // se recorre la respuesta y se genera un array de arrays.
    data.data.forEach(element => {
        arrTipovehiculo = [
            element.descripcion,
            data.count[i],

        ];
        i++;
        // arrTipovehiculo.push('<div class="col text-center">  <button class="btn btn-success btn-sm" type="submit" onclick="verTipovehiculosP('+ element.id +')" data-toggle="modal" data-target="#exampleModalLong"><i class="nav-icon fas fa-search" aria-hidden="true"></i></button> &nbsp; <button class="btn btn-info btn-sm" type="submit" onclick="editarTipovehiculosP('+ element.id +')"><i class="nav-icon fa fa-pencil-alt" aria-hidden="true"></i></button> &nbsp; <button class="btn btn-danger btn-sm" type="submit" onclick="eliminarTipovehiculosP('+ element.id +')"><i class="nav-icon fa fa-times" aria-hidden="true"></i></button> </div>'); 
        arrTipovehiculo.push('<div class="col text-center">  <button class="btn btn-success btn-sm" type="submit" onclick="verTipovehiculosP('+ element.id +')" data-toggle="modal" data-target="#exampleModalLong"><i class="nav-icon fas fa-search" aria-hidden="true"></i></button> &nbsp; <button class="btn btn-info btn-sm" type="submit" onclick="editarTipovehiculosP('+ element.id + ')"><i class="nav-icon fa fa-pencil-alt" aria-hidden="true"></i></button> </div>'); 

        arrTipovehiculos.push(arrTipovehiculo);
    });

    return arrTipovehiculos;
}


var generarDataTable = function( dataSet ) {

  $("#example1").DataTable({
    data: dataSet,
    columns: [
            { title: "Tipo Vehiculo" },
            { title: "Cantidad de Partes" },
            { title: "Acciones" },
            ],
    "responsive": true, "lengthChange": true, "autoWidth": false,
    "paging": true, "ordering": true, "info": true,
      lengthMenu: [
            [10, 25, 50, 100, -1],
            [10, 25, 50, 100, 'All'],
        ],
        "language": {
                url:"../../build/config/languagedatatable.json"
          },
    "buttons": ["copy", "csv", "excel", "pdf", "print", "colvis"]
  }).buttons().container().appendTo('#example1_wrapper .col-md-6:eq(0)');

}



var infoTable = function(){

var url = 'alltipovehiculopartes';

    $.ajax({
            method: "GET",
            url: url_back + url,
            headers: { 
                Authorization: 'Bearer ' + localStorage.access_token
            },
            dataType: 'json',
            success: function(respuesta) {
                // generarDataTable(organizarDatos(respuesta.data));
                generarDataTable(organizarDatos(respuesta));
            },
            error: function() {
                var mensaje = 'Se presentó un error. Por favor, inténtelo mas tarde o la tabla esta vacia';
                sweetMessage('error', mensaje);
            }
        }) 

}


// var renderVehiculo = function() {

// var url ='tipovehiculoPartevehiculo/add.html';
//   $('#main_content').load(url_front + url);
// }



// function eliminarVehiculo(id){//mensaje de desea borrar y eliminar

// var url_eliminar = 'tipovehiculoPartevehiculo/' + id;
// var url_index = 'tipovehiculoPartevehiculo/index.html';

//   if (confirm('¿Está seguro de Borrar?')){

//               $.ajax({
//             method: "DELETE",
//             url: url_back + url_eliminar,
//             headers: { 
//                           Authorization: 'Bearer ' + localStorage.access_token
//                       },
//             dataType: "json",
//             success: function(respuesta) {

//                 var mensaje = 'se borro exitosamente el vehiculo de Placa: ' + respuesta.data.placa + ' de Tipo: ' + respuesta.data.tipovehiculo.descripcion;
//                 sweetMessage('success', mensaje);
                
//                 $('#main_content').load(url_front + url_index);
//             },
//             error: function() {
//                 var mensaje = 'Se presentó un error. Por favor, inténtelo mas tarde.';
//                 sweetMessage('error', mensaje);
//             }
//           })  
//   } else{
//     return false;
//   }
// }

function editarTipovehiculosP(id){//render al editar
  var url_edit = 'tipovehiculoPartevehiculo/edit.html';

  $('#main_content').load(url_front + url_edit);
    localStorage.setItem('editar', id);
}

function verVehiculo(id){
  $('#mymodal').html('');
  localStorage.setItem('ver', id);
  $('#mymodal').load('../tipovehiculoPartevehiculo/show.html',function(){
        $('#exampleModalLong').modal({show:true});
    });
}


$( document ).ready(function() {
  $('.preloader').hide("slow");
  validarLogin();

  infoTable(); 
  // $("#crear").on("click",renderVehiculo);

  var saludos = 'Hola '+ localStorage.nombres;
  $('#saludos').text(saludos);

});


</script>
