<!-- Modal -->
<div class="modal fade" id="ModalLong3" tabindex="-1" role="dialog" aria-labelledby="ModalLongTitle" aria-hidden="true">
    <div class="modal-dialog modal-xl" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="ModalLongTitle">
            <i class="nav-icon fas fa-user"></i>
            Impuesto Articulo </h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>

        <div class="modal-body">
<!--  -->

<div class="card">

  <div class="card-body">
        
        
        <form id="formImpuesto"  method="PUT" action="" enctype="multipart/form-data">

        <div class="row">
          <div class="col-sm-4">


            <div class="form-row">
              <div class="form-group col-md-6">
              <label for="select-tipoimpuestos">Tipo Impuesto </label>
                <select class="form-control" id="select-tipoimpuestos"></select>

              </div>

              <div class="form-group col-md-4">
                  <label for="inputZip">IVA</label>
                <div class="input-group mb-3">
                  <input type="text" class="form-control" id="inputZip">
                  <div class="input-group-append">
                    <span class="input-group-text">%</span>
                  </div>
                </div>
              </div>


            </div>

              <div class="form-group col-md-10">
                <label for="responsable">  IVA Compras (PUC) </label>
                <input class="form-control input-texto-alfanumerico" id="cuentaingreso" placeholder="Nombre de la cuenta PUC de Ingreso">
              </div>
                <input class="form-control input-texto-alfanumerico" id="cuentaingreso_id" hidden>


                <div class="form-group">
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="gridCheck">
                    <label class="form-check-label" for="gridCheck">
                      Adicionar valor al costo del articulo
                    </label>
                  </div>
                </div>


          </div>
          <div class="col-sm-4">


            <div class="form-row">
              <div class="form-group col-md-6">
              <label for="select-tipoimpuestos">Tipo Impuesto </label>
                <select class="form-control" id="select-tipoimpuestos"></select>

              </div>

              <div class="form-group col-md-4">
                  <label for="inputZip">IVA</label>
                <div class="input-group mb-3">
                  <input type="text" class="form-control" id="inputZip">
                  <div class="input-group-append">
                    <span class="input-group-text">%</span>
                  </div>
                </div>
              </div>


            </div>

              <div class="form-group col-md-10">
                <label for="responsable">  IVA Venta (PUC) </label>
                <input class="form-control input-texto-alfanumerico" id="cuentaingreso" placeholder="Nombre de la cuenta PUC de Ingreso">
              </div>
                <input class="form-control input-texto-alfanumerico" id="cuentaingreso_id" hidden>





          </div>
          <div class="col-sm-4">

              <div class="form-group col-md-10">
                <label for="responsable">  Impuesto Consumo (PUC) </label>
                <input class="form-control input-texto-alfanumerico" id="cuentaingreso" placeholder="Nombre de la cuenta PUC de Ingreso">
              </div>
                <input class="form-control input-texto-alfanumerico" id="cuentaingreso_id" hidden>


                <div class="form-row">
                  <div class="form-group col-md-4">
                      <label for="inputZip">Impuesto</label>
                    <div class="input-group mb-3">
                      <input type="text" class="form-control" id="inputZip">
                      <div class="input-group-append">
                        <span class="input-group-text">%</span>
                      </div>
                    </div>
                  </div>
    
                  <div class="form-group col-md-6">
                      <label for="inputZip">Valor Empaque</label>
                    <div class="input-group mb-3">
                      <input type="text" class="form-control" id="inputZip">
                      <div class="input-group-append">
                        <span class="input-group-text">$</span>
                      </div>
                    </div>
                  </div>
    
                </div>

                <div class="row">

                <div class="form-group col-md-6">
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="gridCheck">
                    <label class="form-check-label" for="gridCheck">
                      Aplicar en compra
                    </label>
                  </div>
                </div>
          
                <div class="form-group col-md-6">
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="gridCheck">
                    <label class="form-check-label" for="gridCheck">
                     Adicionar valor al costo 
                    </label>
                  </div>
                </div>

          </div>

        </div>
        </div>

        <hr class="form-group info" style="border: 1%; border-color: rgba(255, 255, 255, 0.073);">
<br>

        <div class="form-row">
          <div class="col-sm-4">


            <div class="form-group col-md-10">
              <label for="responsable">Retefuente Compra (PUC) </label>
              <input class="form-control input-texto-alfanumerico" id="cuentaingreso" placeholder="Cuenta PUC de Retefuente Compra">
          </div>
              <input class="form-control input-texto-alfanumerico" id="cuentaingreso_id" hidden>
            
          

              <div class="form-group col-md-6">
                  <label for="retefuenteporcentaje">Retefuente</label>
                <div class="input-group mb-3">
                    <input type="text" id="retefuenteporcentaje" class="form-control input-numero-decimal2" placeholder="Retefuente">  
                    <div class="input-group-append">
                      <span class="input-group-text">%</span>
                    </div>
                </div> 
            </div>



          </div>
          <div class="col-sm-4">


            <div class="form-group col-md-10">
              <label for="responsable">Retefuente Venta (PUC) </label>
              <input class="form-control input-texto-alfanumerico" id="cuentaingreso" placeholder="Cuenta PUC de Retefuente Venta">
          </div>
              <input class="form-control input-texto-alfanumerico" id="cuentaingreso_id" hidden>
            
          

              <div class="form-group col-md-6">
                  <label for="retefuenteporcentaje">Retefuente</label>
                <div class="input-group mb-3">
                    <input type="text" id="retefuenteporcentaje" class="form-control input-numero-decimal2" placeholder="Retefuente">  
                    <div class="input-group-append">
                      <span class="input-group-text">%</span>
                    </div>
                </div> 
            </div>


          </div>
          <div class="col-sm-4">


            <div class="form-group col-md-12">
              <label for="inputZip">Retencion ICA</label>
              <div class="form-group col-md-7">
              <div class="input-group mb-3">
                <input type="text" class="form-control" id="inputZip">
                <div class="input-group-append">
                  <span class="input-group-text">%</span>
                </div>
              </div>
              </div>
            </div>
            
            <div class="form-group">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="gridCheck">
                <label class="form-check-label" for="gridCheck">
                  Base Retencion ICA
                </label>
              </div>
            </div>
        

          </div>
        </div>

        <hr class="form-group info" style="border: 1%; border-color: rgba(255, 255, 255, 0.073);">

            <div class="col-12 float-right">
                <button type="submit" class="btn btn-primary">Actualizar</button>
                <button type="button" class="btn btn-secondary float-right" data-dismiss="modal">Cerrar</button>
            </div> 

        </form>

    </div>

</div>
</div>




<!--  -->
        </div>
        <div class="modal-footer">
          <input type="text" id="costounitario" hidden>  

        </div>
      </div>
    </div>

<script>


$("#formImpuesto").submit(function(e) {
e.preventDefault(); 

  const form = document.getElementById('formImpuesto');
  const formData = new FormData(form);

    var articulo_id = localStorage.editar;

    var precio0 = $('#precio' +k+0).val()? $('#precio' +k+0).val() : '';

    formData.append("articulo_id", articulo_id);
    formData.append('_method', 'PUT');

         $.ajax({
          method: "POST",
          url: url_back + "impuestos/"+id,
          headers: { 
              Authorization: 'Bearer ' + localStorage.access_token
          },
          dataType: "json",
          data: formData,
          contentType: false,//formData
          processData: false,//formData
          success: function(respuesta) {

                  var mensaje = 'Lista Precio Asociadas actualizado de forma correcta.: ';
                  sweetMessage('success', mensaje); 
                  regresa(true);
          },
          error: function(respuesta) {

              if(respuesta.responseJSON.error){
                  $.each(respuesta.responseJSON.error.message, function (key, item) {
                      var mensaje = item[0];
                      sweetMessage('error', mensaje);
                  });
              }else{
                  var mensaje = 'Se presentó un error. Por favor, inténtelo mas tarde.';
                  sweetMessage('error', mensaje);
              }
              
              regresa(false);
          }
      });
});


function obtenerImpuesto(id){
var url = 'articulos/'+ id;

$.ajax({
    method: "GET",
    url: url_back + url,
    headers: { 
                  Authorization: 'Bearer ' + localStorage.access_token
              },
    dataType: "json",
    success: function(respuesta) {


      console.log(respuesta);

      

    },
    error: function() {
        var mensaje = 'Se presentó un error. Por favor, inténtelo mas tarde.';
        sweetMessage('error', mensaje);
    }
  })  
}





$( document ).ready(function() {
    $('.preloader').hide("slow");
      validarLogin();
      obtenerImpuesto(localStorage.editar);

 
});

</script>

<!-- validaciones -->
<script src="../../build/js/validaciones.js"></script>