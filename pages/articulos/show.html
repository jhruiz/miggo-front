<!-- Modal -->
<!-- Preloader -->
<div class="preloader flex-column justify-content-center align-items-center">
    <img class="animation__shake" src="../../dist/img/AdminLTELogo.png" alt="AdminLTELogo" height="60" width="60">
    </div>
    
    <div class="card" id="content-articulos">
        <div class="card-header">
            <div class="row">
                <div class="col-12">
                    <h4>
                        <i class="nav-icon fas fa-user"></i>
                        Ver Articulo                                  
                    </h4>
                </div>
            </div>
        </div>
    
        <div class="card-body">
            
            <form method="PUT" id="form" action="" enctype="multipart/form-data">
    
                <div class="row">
                    <div class="col-sm-6">
    
                        <div id="mostrarImagen" stye="display:flex;"></div>
                        <div class="form-group">
                        <div class="custom-file">
                        <input class="btn btn-success col fileinput" type="file" id="imagen" disabled>
                        </div>
                        </div>
                      
          
                        <div class="form-group">
                            <label>Referencia</label>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text"><i class="fas fa-id-card"></i></span>
                                </div> 
                            <input type="text" id="referencia" class="form-control input-texto-alfanumerico" placeholder="Referencia" disabled>  
                            </div> 
                        </div> 
    
                        <div class="form-group">
                            <label>PLU</label>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text"><i class="fas fa-id-card"></i></span>
                                </div> 
                                <input type="text" id="plu" class="form-control input-texto-alfanumerico" placeholder="PLU" disabled>  
                            </div> 
                        </div> 
            
                        <div class="form-group">
                            <label>Peso Volumen</label>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text"><i class="fas fa-id-card"></i></span>
                                </div> 
                             <input type="text" id="pesovolumen" class="form-control input-numero" placeholder="Peso Volumen" disabled>  
                                <div class="input-group-append">
                                    <span class="input-group-text">Gr</span>
                                </div>
                            </div> 
                        </div> 
    
                        <div class="form-group">
                            <label>Existencia minima</label>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text"><i class="fas fa-id-card"></i></span>
                                </div> 
                                <input type="text" id="existenciaminima" class="form-control input-numero" placeholder="Existencia minima" disabled>  
                            </div> 
                        </div> 

                        <div class="form-group">
                            <label>Cantidad Ordenar</label>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text"><i class="fas fa-id-card"></i></span>
                                </div> 
                                <input type="text" id="cantidadordenar" class="form-control input-numero" placeholder="Cantidad Ordenar" disabled>  
                            </div> 
                        </div> 

                        <div class="form-group">
                            <label>Descuento</label>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text"><i class="fas fa-id-card"></i></span>
                                </div> 
                                <input type="text" id="descuento" class="form-control input-numero" placeholder="Descuento" disabled>  
                                <div class="input-group-append">
                                    <span class="input-group-text">%</span>
                                </div>
                            </div> 
                        </div> 

                        <div class="form-group">
                            <label>Descuento Fecha VLR</label>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text"><i class="fas fa-id-card"></i></span>
                                </div> 
                                <input type="text" id="descuentoafechavlr" class="form-control input-numero" placeholder="Descuento Fecta VLR" disabled>  
                                <div class="input-group-append">
                                    <span class="input-group-text">%</span>
                                </div> 
                            </div> 
                        </div> 

                        <div class="form-group">
                            <label>Fecha INVIMA:</label>
                                <div class="input-group date" id="fechainvima" data-target-input="nearest">
                                    <div class="input-group-prepend" data-target="#fechainvima" data-toggle="datetimepicker">
                                        <span class="input-group-text"><i class="far fa-calendar-alt"></i></span>
                                      </div>
                                  <input type="text" id="fechainvimas" class="form-control datetimepicker-input" data-target="#fechainvima" disabled/>
                              </div>
                          </div>
            
    
                    </div>
    
    
                    <div class="col-sm-6">


                        <div class="card-info">
                            <div class="card-header">
                              <h3 class="card-title">Caracteristicas</h3>
                            </div>
                              <div class="row">

                                <div class="col-sm-4">
                                    <div class="form-group clearfix">
                                        <div class="form-check">
                                          <input class="form-check-input" type="radio" name="radio1" id="serial" disabled>
                                          <label class="form-check-label">Serial</label>
                                        </div>
                                    </div>
                                  </div>

                                <div class="col-sm-4">
                                  <div class="form-group clearfix">
                                        <div class="form-check">
                                          <input class="form-check-input" type="radio" name="radio1" id="lote" disabled>
                                          <label class="form-check-label">Lote</label>
                                        </div>
                                  </div>
                                </div>

                                <div class="row">
                                    <div class="col-sm-6">
                                        <div class="form-group clearfix">
                                            <div class="form-check">
                                              <input class="form-check-input" type="radio" name="radio1" id="color" disabled>
                                              <label class="form-check-label">Color</label>
                                            </div>
                                        </div>
                                </div>

                              </div>

                              <div class="col-sm-4">
                                <div class="form-group clearfix">
                                  <div class="icheck-primary d-inline">
                                    <input type="checkbox" id="activo" disabled>
                                    <label for="activo">
                                      Activo
                                    </label>
                                  </div>
                                </div>
                              </div>

                                <div class="col-sm-6">
                                    <div class="form-group clearfix">
                                        <div class="icheck-success d-inline">
                                          <input type="checkbox" id="talla" disabled>
                                          <label for="talla">
                                            Talla
                                          </label>
                                        </div>
                                      </div>
                                </div>
                              </div>


                          </div>
    
                        <div class="form-group">
                            <label>Codigo <code> &nbsp;*</code></label>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text"><i class="fas fa-id-card"></i></span>
                                </div> 
                                <input type="text" id="codigo" class="form-control input-texto-alfanumerico" placeholder="Codigo" disabled>  <code>&nbsp;*</code>
                            </div> 
                        </div> 
                      
                        <div class="form-group">
                            <label>Nombre <code> &nbsp;*</code></label>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text"><i class="fas fa-id-card"></i></span>
                                </div> 
                                <input type="text" id="nombre" class="form-control input-texto-alfanumerico" placeholder="Nombre" disabled>  <code>&nbsp;*</code>
                            </div> 
                        </div> 
    
                        <div class="form-group">
                            <label>Costo unitario</label>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text"><i class="fas fa-id-card"></i></span>
                                </div> 
                               <input type="text" id="costounitario" class="form-control input-numero" placeholder="Costo Unitario" disabled>  
                            </div> 
                        </div> 

                        <div class="form-group">
                            <label>Costo Barras</label>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text"><i class="fas fa-id-card"></i></span>
                                </div> 
                               <input type="text" id="costobarras" class="form-control input-numero" placeholder="Costo Barras" disabled>  
                            </div> 
                        </div> 
    
                        <div class="form-group">
                            <label>Nombre POS</label>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text"><i class="fas fa-id-card"></i></span>
                                </div> 
                               <input type="text" id="posnombre" class="form-control input-numero" placeholder="Nombre POS" disabled>  
                            </div> 
                        </div> 

                        <div class="form-group">
                            <label>REG INVIMA</label>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text"><i class="fas fa-id-card"></i></span>
                                </div> 
                               <input type="text" id="reginvima" class="form-control input-numero" placeholder="REG INVIMA" disabled>  
                            </div> 
                        </div>
                        
                        <div class="form-group">
                            <label>Costos Promedio Bodegas</label>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text"><i class="fas fa-id-card"></i></span>
                                </div> 
                                <input type="text" id="costospromediobodegas" class="form-control input-numero-decimal2" placeholder="Costos Promedio Bodegas" disabled>  
                            </div> 
                        </div> 

                        <div class="form-group">
                            <label>Ultimo Costo</label>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text"><i class="fas fa-id-card"></i></span>
                                </div> 
                                <input type="text" id="ultimocosto" class="form-control input-numero-decimal2" placeholder="Ultimo Costo" disabled>  
                            </div> 
                        </div> 

                        <div class="form-group">
                            <label>Fecha Ultimacompra</label>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text"><i class="fas fa-id-card"></i></span>
                                </div> 
                                <input type="text" id="fechaultimacompra" class="form-control input-texto-alfanumerico" placeholder="Fecha Ultimacompra" disabled>  
                            </div> 
                        </div> 
    
                    </div>
    
              </div>
              <div class="row">
                    <div class="col-sm-6">
    
                        <div class="form-group">
                            <label>Descripcion</label>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text"><i class="fas fa-id-card"></i></span>
                                </div> 
                                <textarea id="descripcion" class="form-control" rows="2" placeholder="descripcion ..." disabled></textarea>
            
                            </div> 
                        </div> 
    
                    </div>
                    <div class="col-sm-6">
    
                            <div class="form-group">
                                <label for="exampleSelectRounded0">Marca Articulo </label>
                                <select class="custom-select rounded-0" id="select-marcas" disabled>
                                  <!-- <option>Value 1</option> -->
                
                                </select>
                              </div> 
    
                    </div>
                </div>

                <div class="row">
                    <div class="col-sm-6">
    
                        <div class="form-group">
                            <label for="exampleSelectRounded0">Grupo Inventario</label>
                            <select class="custom-select rounded-0" id="select-grupoinventario" disabled>
                              <!-- <option>Value 1</option> -->
            
                            </select>
                          </div> 

                          <div class="form-group">
                            <label for="exampleSelectRounded0">Sub-Grupo 2:</label>
                            <select class="custom-select rounded-0" id="select-subgrupoinventario2" disabled>
                              <!-- <option>Value 1</option> -->
            
                            </select>
                          </div> 
                          
    
                    </div>
                    <div class="col-sm-6">
    

                         <div class="form-group">
                            <label for="exampleSelectRounded0">Sub-Grupo 1:</label>
                            <select class="custom-select rounded-0" id="select-subgrupoinventario1" disabled>
                              <!-- <option>Value 1</option> -->
            
                            </select>
                        </div> 

                        <div class="form-group">
                        <label for="exampleSelectRounded0">Sub-Grupo 3:</label>
                            <select class="custom-select rounded-0" id="select-subgrupoinventario3" disabled>
                                <!-- <option>Value 1</option> -->
            
                            </select>
                        </div> 

                            <input type="text" id="id" class="form-control" hidden>
                            <!-- <input type="text" id="posicion" class="form-control"> -->
    
                    </div>
                </div>
    
                <div class="col-12 float-right">
                    <!-- <button type="submit" class="btn btn-primary float-right">Actualizar</button> -->
                </div> 
    
    
            </form>
        </div>
    
    </div>


<script>

function obtenerArticulo(id){
    var url = 'articulos/'+ id;
    
    $.ajax({
        method: "GET",
        url: url_back + url,
        headers: { 
                      Authorization: 'Bearer ' + localStorage.access_token
                  },
        dataType: "json",
        success: function(respuesta) {

            respuesta.data.activo == 1 ? $('#activo').prop( "checked", true ) : $('#activo').prop( "checked", false );
            respuesta.data.lote == 1 ? $('#lote').prop( "checked", true ) : $('#lote').prop( "checked", false );
            respuesta.data.serial == 1 ? $('#serial').prop( "checked", true ) : $('#serial').prop( "checked", false );
            respuesta.data.talla == 1 ? $('#talla').prop( "checked", true ) : $('#talla').prop( "checked", false );
            respuesta.data.color == 1 ? $('#color').prop( "checked", true ) : $('#color').prop( "checked", false );

            $('#codigo').val(respuesta.data.codigo);
            $('#nombre').val(respuesta.data.nombre);
            $('#costounitario').val(respuesta.data.costounitario);
            $('#posnombre').val(respuesta.data.posnombre);
            $('#descripcion').val(respuesta.data.descripcion);
            $('#fechainvimas').val(respuesta.data.fechainvima);
            $('#costobarras').val(respuesta.data.costobarras);
            $('#referencia').val(respuesta.data.referencia);
            $('#plu').val(respuesta.data.plu);
            $('#pesovolumen').val(respuesta.data.pesovolumen);
            $('#reginvima').val(respuesta.data.reginvima);
            $('#existenciaminima').val(respuesta.data.existenciaminima);
            $('#cantidadordenar').val(respuesta.data.cantidadordenar);
            $('#descuento').val(respuesta.data.descuento * 100);
            $('#descuentoafechavlr').val(respuesta.data.descuentoafechavlr * 100);
            $('#costospromediobodegas').val(respuesta.data.costospromediobodegas);
            $('#ultimocosto').val(respuesta.data.ultimocosto);
            $('#fechaultimacompra').val(respuesta.data.fechaultimacompra);

            if(respuesta.data.imagen){
                const ul = document.getElementById("mostrarImagen");
                const imagen = document.createElement("img");
                imagen.width = 200;
                imagen.src = url_img + 'articulos/'+ respuesta.data.imagen;
                ul.appendChild(imagen);
              }else{
                const ul = document.getElementById("mostrarImagen");
                const imagen = document.createElement("img");
                imagen.width = 200;
                imagen.src = url_front + 'articulos/defecto.jpg';
                ul.appendChild(imagen);
              }

            if(respuesta.data.marca_id){
                    obtenerSelect('marcas','#select-marcas',respuesta.data.marca_id);
            }else{
                    obtenerSelects('marcas','#select-marcas');
            }

            if(respuesta.data.grupoinventario_id){
                    $('#id').val(respuesta.data.grupoinventario_id);//TODO: metodo para recargar todo los grupos 
                    obtenerGrupoinventario(respuesta.data.grupoinventario_id);
            }else{
                 obtenerGrupoinventarios(); 
            }

        },
        error: function() {
            var mensaje = 'Se presentó un error. Por favor, inténtelo mas tarde.';
            sweetMessage('error', mensaje);
        }
      })  
    }

function obtenerGrupoinventario(id) { 
var url = 'grupoinventarios/'+id;

  $.ajax({
      method: "GET",
      url: url_back + url,    headers: { 
          Authorization: 'Bearer ' + localStorage.access_token
      },
      dataType: "json",
      success: function(respuesta) {

                if(respuesta.data.posicion == 3){
                    $('#select-subgrupoinventario3').html('<option value="'+ respuesta.data.id+'" >'+respuesta.data.codigo+'-'+respuesta.data.descripcion+'</option>');
                    $('#select-subgrupoinventario2').html('<option value="'+ respuesta.data.grupoinventario.id+'" >'+respuesta.data.grupoinventario.codigo+'-'+respuesta.data.grupoinventario.descripcion+'</option>');
                    $('#select-subgrupoinventario1').html('<option value="'+ respuesta.data.grupoinventario.grupoinventario.id+'" >'+respuesta.data.grupoinventario.grupoinventario.codigo+'-'+respuesta.data.grupoinventario.grupoinventario.descripcion+'</option>');

                    obtenerGrupoinventarios(respuesta.data.grupoinventario.grupoinventario.grupoinventario.id)
                }else if(respuesta.data.posicion == 2){
                    $('#select-subgrupoinventario2').html('<option value="'+ respuesta.data.id+'" >'+respuesta.data.codigo+'-'+respuesta.data.descripcion+'</option>');
                    $('#select-subgrupoinventario1').html('<option value="'+ respuesta.data.grupoinventario.id+'" >'+respuesta.data.grupoinventario.codigo+'-'+respuesta.data.grupoinventario.descripcion+'</option>');

                    obtenerGrupoinventarios(respuesta.data.grupoinventario.grupoinventario.id)
                }else if(respuesta.data.posicion == 1){
                    $('#select-subgrupoinventario1').html('<option value="'+ respuesta.data.id+'" >'+respuesta.data.codigo+'-'+respuesta.data.descripcion+'</option>');

                    obtenerGrupoinventarios(respuesta.data.grupoinventario.id)
                }
      },
      error: function() {
          var mensaje = 'Se presentó un error. Por favor, inténtelo mas tarde.';
          sweetMessage('error', mensaje);
      }
    })     
  }


function obtenerGrupoinventarios(id = null) { 
var url = 'grupoinventarios';

$.ajax({
      method: "GET",
      url: url_back + url,    headers: { 
          Authorization: 'Bearer ' + localStorage.access_token
      },
      dataType: "json",
      success: function(respuesta) {

          $('#select-grupoinventario').html(crearHtmlGrupo(respuesta));
      },
      error: function() {
          var mensaje = 'Se presentó un error. Por favor, inténtelo mas tarde.';
          sweetMessage('error', mensaje);
      }
    })     
  }
  
  var crearHtmlGrupo = function(data) {
      var html = '<option value="" selected="true" disabled="disabled">Selecione...</option>';
          $.each(data, function (key, item) {
            if(localStorage.empresa_id == item.empresa_id){
              html += '<option value="'+ item.id+'">';
              html += item.codigo+'-'+item.descripcion;
              html += '</option>';
            }

          });
      return html;
  }

 





$( document ).ready(function() {
    $('.preloader').hide("slow");
    validarLogin();
    obtenerArticulo(localStorage.ver);

    $('#descripcion').validCampo('abcdefghijklmnopqrstuvwxyziou 0123456789-');
});




</script>

<!-- validaciones -->
<script src="../../build/js/validaciones.js"></script>

